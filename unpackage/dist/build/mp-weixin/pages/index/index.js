(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"3e9f":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var o={uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,"9c86"))},uBadge:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-badge/u-badge")]).then(n.bind(null,"05a5"))},uSwiper:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-swiper/u-swiper")]).then(n.bind(null,"8726"))},uEmpty:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-empty/u-empty")]).then(n.bind(null,"ac8a"))}},r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.hasNewAffiche()),o=e.__map(e.boys,(function(t,n){var o=e.__get_orig(t),r=e.totalRun(t);return{$orig:o,m1:r}})),r=e.__map(e.girls,(function(t,n){var o=e.__get_orig(t),r=e.totalRun(t);return{$orig:o,m2:r}}));e.$mp.data=Object.assign({},{$root:{m0:n,l0:o,l1:r}})},i=[]},"4bfe":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n("7e26")),r=n("26cb");function i(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a={data:function(){return{sweperList:["https://cdn.uviewui.com/uview/swiper/swiper1.png","https://cdn.uviewui.com/uview/swiper/swiper2.png","https://cdn.uviewui.com/uview/swiper/swiper3.png"],scrollList:[{src:n("b020"),txt:"选课",nav:"courseSelection"},{src:n("bccf"),txt:"我的课表",nav:"timeTable"},{src:n("d6d4"),txt:"公告",nav:"notify"},{src:n("b21e"),txt:"信息设置",nav:"setting"}],boys:[],girls:[]}},beforeCreate:function(){var t=this;new Promise((function(t,n){e.login({provider:"weixin",success:function(e){t(e)},fail:function(e){n(e)}})})).then((function(n){var r="https://api.weixin.qq.com/sns/jscode2session?appid=wxd84fa65bb8506c82&secret=7cd789f8f705c776cf8de5856619d771&js_code="+n.code;e.request({url:r,method:"GET",success:function(n){console.log(n.data.openid),e.request({url:o.default+"/login",method:"GET",data:{openid:n.data.openid},success:function(n){var o=n.data;-1===o.code?e.showToast({title:"服务器故障",icon:"error"}):(t.setUserInfo(o.studentInfo),t.getAllCourse(),console.log(t.userinfo))},fail:function(t){throw e.showToast({title:"网络连接故障",icon:"error"}),t}})}})})).catch((function(e){throw e}));var n=e.getStorageSync("affiches"),r=n?n.length:0;e.request({url:o.default+"/affiche",method:"GET",data:{length:r},success:function(n){for(var o=n.data,r=o.affiches.length,i=0;i<r;i++)o.affiches[r-i-1].wasRead=!(i<o.code);t.setNotify(o.affiches),e.setStorageSync("affiches",o.affiches)},fail:function(e){throw"获取公告失败"+e}}),e.request({url:o.default+"/runrank",method:"GET",data:{top:3},success:function(e){var n=e.data;1===n.code&&(t.girls=n.girls,t.boys=n.boys)},fail:function(e){throw e}})},computed:c({},(0,r.mapState)({notify:function(e){return e.notify},userinfo:function(e){return e.userinfo}})),methods:c({totalRun:function(e){for(var t=e.run,n=0,o=0;o<t.length;o++)n+=t[o].mile;return(n/1e3).toFixed(2)},navTo:function(t){e.navigateTo({url:"/pages/".concat(t,"/").concat(t)})},hasNewAffiche:function(){return this.notify.filter((function(e){return!e.wasRead})).length},getAllCourse:function(){var t=this;e.request({url:o.default+"/getcourses",method:"GET",data:{id:this.userinfo.id},success:function(e){var n=e.data;1===n.code&&t.setCourses(n.courses)},fail:function(t){e.showToast({title:"网络连接故障",icon:"error"})}})}},(0,r.mapMutations)(["setNotify","setUserInfo","setCourses"]))};t.default=a}).call(this,n("543d")["default"])},"54d4":function(e,t,n){"use strict";n.r(t);var o=n("4bfe"),r=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},"6fcc1":function(e,t,n){"use strict";(function(e){n("60b4");o(n("66fd"));var t=o(n("ffc1"));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},"7c37":function(e,t,n){"use strict";var o=n("ea76"),r=n.n(o);r.a},ea76:function(e,t,n){},ffc1:function(e,t,n){"use strict";n.r(t);var o=n("3e9f"),r=n("54d4");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("7c37");var u,c=n("f0c5"),s=Object(c["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],u);t["default"]=s.exports}},[["6fcc1","common/runtime","common/vendor"]]]);